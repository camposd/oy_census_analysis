geom_text(aes(label = if_else(percent > .05,
scales::percent(percent, accuracy = .1),
""),
group = !!fill_col),
position = position_dodge(width = 1),
vjust = 1.2) +
geom_errorbar(aes(ymin = percent, ymax = percent_upp,
group = !!fill_col),
width = .5,
position = position_dodge(1))+
theme_classic() +
scale_y_continuous(labels = scales::percent) +
erase_y_axis +
erase_x_legend +
theme(axis.text.x = element_text(face = 'bold')) +
labs(
caption = "Cells representing less than 5% suppressed for clarity")
# scale_fill_manual(values = color_contrast_hh)
}
basic_plot_dodge(analysis_data$hh_food_stamps)
basic_plot_dodge <- function(data, fill_label = NULL){
fill_col = names(data)[2] %>% rlang::sym()
x_col =    names(data)[str_detect(names(data), "oy")] %>% rlang::sym()
data %>%
filter(!str_detect(!!x_col, '(Everyone)|(Eveyrone)')) %>%
ggplot(aes(x = !!x_col, y = percent, fill = !!fill_col)) +
geom_col(color = 'black',
position = 'dodge') +
geom_text(aes(label = if_else(percent > .05,
scales::percent(percent, accuracy = .1),
""),
group = !!fill_col),
position = position_dodge(width = 1),
vjust = 1.3) +
geom_errorbar(aes(ymin = percent, ymax = percent_upp,
group = !!fill_col),
width = .5,
position = position_dodge(1))+
theme_classic() +
scale_y_continuous(labels = scales::percent) +
erase_y_axis +
erase_x_legend +
theme(axis.text.x = element_text(face = 'bold')) +
labs(
caption = "Cells representing less than 5% suppressed for clarity")
# scale_fill_manual(values = color_contrast_hh)
}
basic_plot_dodge(analysis_data$hh_food_stamps)
basic_plot_dodge <- function(data, fill_label = NULL){
fill_col = names(data)[2] %>% rlang::sym()
x_col =    names(data)[str_detect(names(data), "oy")] %>% rlang::sym()
data %>%
filter(!str_detect(!!x_col, '(Everyone)|(Eveyrone)')) %>%
ggplot(aes(x = !!x_col, y = percent, fill = !!fill_col)) +
geom_col(color = 'black',
position = 'dodge') +
geom_text(aes(label = if_else(percent > .05,
scales::percent(percent, accuracy = .1),
""),
group = !!fill_col),
position = position_dodge(width = .5),
vjust = 1.3) +
geom_errorbar(aes(ymin = percent, ymax = percent_upp,
group = !!fill_col),
width = .5,
position = position_dodge(1))+
theme_classic() +
scale_y_continuous(labels = scales::percent) +
erase_y_axis +
erase_x_legend +
theme(axis.text.x = element_text(face = 'bold')) +
labs(
caption = "Cells representing less than 5% suppressed for clarity")
# scale_fill_manual(values = color_contrast_hh)
}
basic_plot_dodge(analysis_data$hh_food_stamps)
basic_plot_dodge <- function(data, fill_label = NULL){
fill_col = names(data)[2] %>% rlang::sym()
x_col =    names(data)[str_detect(names(data), "oy")] %>% rlang::sym()
data %>%
filter(!str_detect(!!x_col, '(Everyone)|(Eveyrone)')) %>%
ggplot(aes(x = !!x_col, y = percent, fill = !!fill_col)) +
geom_col(color = 'black',
position = 'dodge') +
geom_text(aes(label = if_else(percent > .05,
scales::percent(percent, accuracy = .1),
""),
group = !!fill_col),
position = position_dodge(width = .7),
vjust = 1.3) +
geom_errorbar(aes(ymin = percent, ymax = percent_upp,
group = !!fill_col),
width = .5,
position = position_dodge(1))+
theme_classic() +
scale_y_continuous(labels = scales::percent) +
erase_y_axis +
erase_x_legend +
theme(axis.text.x = element_text(face = 'bold')) +
labs(
caption = "Cells representing less than 5% suppressed for clarity")
# scale_fill_manual(values = color_contrast_hh)
}
basic_plot_dodge(analysis_data$hh_food_stamps)
basic_plot_dodge <- function(data, fill_label = NULL){
fill_col = names(data)[2] %>% rlang::sym()
x_col =    names(data)[str_detect(names(data), "oy")] %>% rlang::sym()
data %>%
filter(!str_detect(!!x_col, '(Everyone)|(Eveyrone)')) %>%
ggplot(aes(x = !!x_col, y = percent, fill = !!fill_col)) +
geom_col(color = 'black',
position = 'dodge') +
geom_text(aes(label = if_else(percent > .05,
scales::percent(percent, accuracy = .1),
""),
group = !!fill_col),
position = position_dodge(width = .8),
vjust = 1.3) +
geom_errorbar(aes(ymin = percent, ymax = percent_upp,
group = !!fill_col),
width = .5,
position = position_dodge(1))+
theme_classic() +
scale_y_continuous(labels = scales::percent) +
erase_y_axis +
erase_x_legend +
theme(axis.text.x = element_text(face = 'bold')) +
labs(
caption = "Cells representing less than 5% suppressed for clarity")
# scale_fill_manual(values = color_contrast_hh)
}
basic_plot_dodge(analysis_data$hh_food_stamps)
basic_plot_dodge <- function(data, fill_label = NULL){
fill_col = names(data)[2] %>% rlang::sym()
x_col =    names(data)[str_detect(names(data), "oy")] %>% rlang::sym()
data %>%
filter(!str_detect(!!x_col, '(Everyone)|(Eveyrone)')) %>%
ggplot(aes(x = !!x_col, y = percent, fill = !!fill_col)) +
geom_col(color = 'black',
position = 'dodge') +
geom_text(aes(label = if_else(percent > .05,
scales::percent(percent, accuracy = .1),
""),
group = !!fill_col),
position = position_dodge(width = .87),
vjust = 1.3) +
geom_errorbar(aes(ymin = percent, ymax = percent_upp,
group = !!fill_col),
width = .5,
position = position_dodge(1))+
theme_classic() +
scale_y_continuous(labels = scales::percent) +
erase_y_axis +
erase_x_legend +
theme(axis.text.x = element_text(face = 'bold')) +
labs(
caption = "Cells representing less than 5% suppressed for clarity")
# scale_fill_manual(values = color_contrast_hh)
}
basic_plot_dodge(analysis_data$hh_food_stamps)
basic_plot_dodge <- function(data, fill_label = NULL){
fill_col = names(data)[2] %>% rlang::sym()
x_col =    names(data)[str_detect(names(data), "oy")] %>% rlang::sym()
data %>%
filter(!str_detect(!!x_col, '(Everyone)|(Eveyrone)')) %>%
ggplot(aes(x = !!x_col, y = percent, fill = !!fill_col)) +
geom_col(color = 'black',
position = 'dodge') +
geom_text(aes(label = paste0(scales::percent(percent, accuracy = .1),
figure_helpers$fig_help$newline,
figure_helpers$fig_help$N,
n),
group = !!fill_col),
position = position_dodge(width = .87),
vjust = 1.3) +
geom_errorbar(aes(ymin = percent, ymax = percent_upp,
group = !!fill_col),
width = .5,
position = position_dodge(1))+
theme_classic() +
scale_y_continuous(labels = scales::percent) +
erase_y_axis +
erase_x_legend +
theme(axis.text.x = element_text(face = 'bold')) +
labs(
caption = "Cells representing less than 5% suppressed for clarity")
# scale_fill_manual(values = color_contrast_hh)
}
basic_plot_dodge(analysis_data$hh_food_stamps)
2795 + 1176
ls()
analysis_data$head_of_household$n %>% sum()
analysis_data$head_of_household
41771 + 3935
?format()
basic_plot_dodge <- function(data, fill_label = NULL){
fill_col = names(data)[2] %>% rlang::sym()
x_col =    names(data)[str_detect(names(data), "oy")] %>% rlang::sym()
data %>%
filter(!str_detect(!!x_col, '(Everyone)|(Eveyrone)')) %>%
ggplot(aes(x = !!x_col, y = percent, fill = !!fill_col)) +
geom_col(color = 'black',
position = 'dodge') +
geom_text(aes(label = paste0(scales::percent(percent, accuracy = .1),
figure_helpers$fig_help$newline,
figure_helpers$fig_help$N,
n),
group = !!fill_col),
position = position_dodge(width = .87),
vjust = 1.3,
size = 2) +
geom_errorbar(aes(ymin = percent, ymax = percent_upp,
group = !!fill_col),
width = .5,
position = position_dodge(1))+
theme_classic() +
scale_y_continuous(labels = scales::percent) +
erase_y_axis +
erase_x_legend +
theme(axis.text.x = element_text(face = 'bold')) +
labs(
caption = "Cells representing less than 5% suppressed for clarity")
# scale_fill_manual(values = color_contrast_hh)
}
basic_plot_dodge(analysis_data$hh_food_stamps)
basic_plot_dodge <- function(data, fill_label = NULL){
fill_col = names(data)[2] %>% rlang::sym()
x_col =    names(data)[str_detect(names(data), "oy")] %>% rlang::sym()
data %>%
filter(!str_detect(!!x_col, '(Everyone)|(Eveyrone)')) %>%
ggplot(aes(x = !!x_col, y = percent, fill = !!fill_col)) +
geom_col(color = 'black',
position = 'dodge') +
geom_text(aes(label = paste0(scales::percent(percent, accuracy = .1),
figure_helpers$fig_help$newline,
figure_helpers$fig_help$N,
n),
group = !!fill_col),
position = position_dodge(width = .87),
vjust = 1.3,
size = 3) +
geom_errorbar(aes(ymin = percent, ymax = percent_upp,
group = !!fill_col),
width = .5,
position = position_dodge(1))+
theme_classic() +
scale_y_continuous(labels = scales::percent) +
erase_y_axis +
erase_x_legend +
theme(axis.text.x = element_text(face = 'bold')) +
labs(
caption = "Cells representing less than 5% suppressed for clarity")
# scale_fill_manual(values = color_contrast_hh)
}
basic_plot_dodge(analysis_data$hh_food_stamps)
basic_plot_dodge <- function(data, fill_label = NULL){
fill_col = names(data)[2] %>% rlang::sym()
x_col =    names(data)[str_detect(names(data), "oy")] %>% rlang::sym()
data %>%
filter(!str_detect(!!x_col, '(Everyone)|(Eveyrone)')) %>%
ggplot(aes(x = !!x_col, y = percent, fill = !!fill_col)) +
geom_col(color = 'black',
position = 'dodge') +
geom_text(aes(label = paste0(scales::percent(percent, accuracy = .1),
figure_helpers$fig_help$newline,
figure_helpers$fig_help$N,
n),
group = !!fill_col),
position = position_dodge(width = .87),
vjust = 1.3,
size = 4) +
geom_errorbar(aes(ymin = percent, ymax = percent_upp,
group = !!fill_col),
width = .5,
position = position_dodge(1))+
theme_classic() +
scale_y_continuous(labels = scales::percent) +
erase_y_axis +
erase_x_legend +
theme(axis.text.x = element_text(face = 'bold')) +
labs(
caption = "Cells representing less than 5% suppressed for clarity")
# scale_fill_manual(values = color_contrast_hh)
}
basic_plot_dodge(analysis_data$hh_food_stamps)
basic_plot_dodge <- function(data, fill_label = NULL){
fill_col = names(data)[2] %>% rlang::sym()
x_col =    names(data)[str_detect(names(data), "oy")] %>% rlang::sym()
data %>%
filter(!str_detect(!!x_col, '(Everyone)|(Eveyrone)')) %>%
ggplot(aes(x = !!x_col, y = percent, fill = !!fill_col)) +
geom_col(color = 'black',
position = 'dodge') +
geom_text(aes(label = paste0(scales::percent(percent, accuracy = .1),
figure_helpers$fig_help$newline,
figure_helpers$fig_help$N,
format(n, big.mark = ',')),
group = !!fill_col),
position = position_dodge(width = .87),
vjust = 1.3,
size = 4) +
geom_errorbar(aes(ymin = percent, ymax = percent_upp,
group = !!fill_col),
width = .5,
position = position_dodge(1))+
theme_classic() +
scale_y_continuous(labels = scales::percent) +
erase_y_axis +
erase_x_legend +
theme(axis.text.x = element_text(face = 'bold')) +
labs(
caption = "Cells representing less than 5% suppressed for clarity")
# scale_fill_manual(values = color_contrast_hh)
}
basic_plot_dodge(analysis_data$hh_food_stamps)
basic_plot_dodge(analysis_data$hh_average_income)
basic_plot_dodge(analysis_data$hh_language)
basic_plot_dodge(analysis_data$hh_hh_type)
basic_plot_dodge(analysis_data$hh_married)
basic_plot_dodge(analysis_data$hh_workers_in_fam)
basic_plot_dodge(analysis_data$hh_migration)
basic_plot_dodge <- function(data, fill_label = NULL){
fill_col = names(data)[2] %>% rlang::sym()
x_col =    names(data)[str_detect(names(data), "oy")] %>% rlang::sym()
data %>%
filter(!str_detect(!!x_col, '(Everyone)|(Eveyrone)')) %>%
ggplot(aes(x = !!x_col, y = percent, fill = !!fill_col)) +
geom_col(color = 'black',
position = 'dodge') +
geom_text(aes(label = paste(scales::percent(percent, accuracy = .1),
figure_helpers$fig_help$newline,
figure_helpers$fig_help$N,
format(n, big.mark = ',')),
group = !!fill_col),
position = position_dodge(width = .87),
vjust = 1.3,
size = 4) +
geom_errorbar(aes(ymin = percent, ymax = percent_upp,
group = !!fill_col),
width = .5,
position = position_dodge(1))+
theme_classic() +
scale_y_continuous(labels = scales::percent) +
erase_y_axis +
erase_x_legend +
theme(axis.text.x = element_text(face = 'bold')) +
labs(
caption = "Cells representing less than 5% suppressed for clarity")
# scale_fill_manual(values = color_contrast_hh)
}
basic_plot_dodge(analysis_data$hh_migration)
hh_data <-
analysis_data[str_detect(names(analysis_data), '^hh')]
hh_data
plots <-
map(hh_data, basic_plot_dodge)
plots$hh_num_children
plots$hh_same_sex_married
plots$hh_commute_bracket
plots$hh_same_sex_married
plots$hh_edu_attained
plots$hh_transportation_mode
plots$hh_multigen
basic_plot_dodge(analysis_data$partnered)
analysis_data$head_of_household
analysis_data$head_of_household_alt
analysis_data$food_stamps %>%
basic_plot_dodge() +
labs(fill = "Food Stamp Recipient") +
wrap_x_labels +
scale_fill_manual(values = color_contrast_alt)
analysis_data$workers_in_fam %>%
basic_plot_dodge() +
labs(fill = "Number of workers in Family") +
wrap_x_labels +
scale_fill_manual(values = c(color_contrast_alt[2], color_palette_light(4)))
basic_plot_dodge <- function(data, fill_label = NULL){
fill_col = names(data)[2] %>% rlang::sym()
x_col =    names(data)[str_detect(names(data), "oy")] %>% rlang::sym()
data %>%
filter(!str_detect(!!x_col, '(Everyone)|(Eveyrone)')) %>%
ggplot(aes(x = !!x_col, y = percent, fill = !!fill_col)) +
geom_col(color = 'black',
position = 'dodge') +
geom_text(aes(label = scales::percent(percent, accuracy = .1)),
group = !!fill_col),
position = position_dodge(width = .87),
vjust = 1.3,
size = 4) +
geom_errorbar(aes(ymin = percent, ymax = percent_upp,
group = !!fill_col),
width = .5,
position = position_dodge(1))+
theme_classic() +
scale_y_continuous(labels = scales::percent) +
erase_y_axis +
erase_x_legend +
theme(axis.text.x = element_text(face = 'bold')) +
labs(
caption = "Cells representing less than 5% suppressed for clarity")
# scale_fill_manual(values = color_contrast_hh)
}
basic_plot_dodge <- function(data, fill_label = NULL){
fill_col = names(data)[2] %>% rlang::sym()
x_col =    names(data)[str_detect(names(data), "oy")] %>% rlang::sym()
data %>%
filter(!str_detect(!!x_col, '(Everyone)|(Eveyrone)')) %>%
ggplot(aes(x = !!x_col, y = percent, fill = !!fill_col)) +
geom_col(color = 'black',
position = 'dodge') +
geom_text(aes(label = scales::percent(percent, accuracy = .1)),
group = !!fill_col),
position = position_dodge(width = .87),
vjust = 1.3,
size = 4) +
geom_errorbar(aes(ymin = percent, ymax = percent_upp,
group = !!fill_col),
width = .5,
position = position_dodge(1))+
theme_classic() +
scale_y_continuous(labels = scales::percent) +
erase_y_axis +
erase_x_legend +
theme(axis.text.x = element_text(face = 'bold')) +
labs(
caption = "Cells representing less than 5% suppressed for clarity")
# scale_fill_manual(values = color_contrast_hh)
}
basic_plot_dodge <- function(data, fill_label = NULL){
fill_col = names(data)[2] %>% rlang::sym()
x_col =    names(data)[str_detect(names(data), "oy")] %>% rlang::sym()
data %>%
filter(!str_detect(!!x_col, '(Everyone)|(Eveyrone)')) %>%
ggplot(aes(x = !!x_col, y = percent, fill = !!fill_col)) +
geom_col(color = 'black',
position = 'dodge') +
geom_text(aes(label = scales::percent(percent, accuracy = .1),
group = !!fill_col),
position = position_dodge(width = .87),
vjust = 1.3,
size = 4) +
geom_errorbar(aes(ymin = percent, ymax = percent_upp,
group = !!fill_col),
width = .5,
position = position_dodge(1))+
theme_classic() +
scale_y_continuous(labels = scales::percent) +
erase_y_axis +
erase_x_legend +
theme(axis.text.x = element_text(face = 'bold')) +
labs(
caption = "Cells representing less than 5% suppressed for clarity")
# scale_fill_manual(values = color_contrast_hh)
}
analysis_data$workers_in_fam %>%
basic_plot_dodge() +
labs(fill = "Number of workers in Family") +
wrap_x_labels +
scale_fill_manual(values = c(color_contrast_alt[2], color_palette_light(4)))
basic_plot_dodge <- function(data, fill_label = NULL){
fill_col = names(data)[2] %>% rlang::sym()
x_col =    names(data)[str_detect(names(data), "oy")] %>% rlang::sym()
data %>%
filter(!str_detect(!!x_col, '(Everyone)|(Eveyrone)')) %>%
ggplot(aes(x = !!x_col, y = percent, fill = !!fill_col)) +
geom_col(color = 'black',
position = 'dodge') +
geom_text(aes(label = scales::percent(percent, accuracy = .1),
group = !!fill_col),
position = position_dodge(width = .87),
vjust = 1.3) +
geom_errorbar(aes(ymin = percent, ymax = percent_upp,
group = !!fill_col),
width = .5,
position = position_dodge(1))+
theme_classic() +
scale_y_continuous(labels = scales::percent) +
erase_y_axis +
erase_x_legend +
theme(axis.text.x = element_text(face = 'bold')) +
labs(
caption = "Cells representing less than 5% suppressed for clarity")
# scale_fill_manual(values = color_contrast_hh)
}
analysis_data$children %>%
basic_plot_dodge() +
labs(fill = "Parental Status") +
wrap_x_labels +
scale_fill_manual(values = color_contrast_alt)
analysis_data$food_stamps %>%
basic_plot_dodge() +
labs(fill = "Food Stamp Recipient") +
wrap_x_labels +
scale_fill_manual(values = color_contrast_alt)
analysis_data$hh_type %>%
basic_plot_dodge() +
labs(fill = "Type of Household") +
scale_fill_manual(values = c(color_contrast[2], color_palette_light(8)))
analysis_data$workers_in_fam %>%
basic_plot_dodge() +
labs(fill = "Number of workers in Family") +
wrap_x_labels +
scale_fill_manual(values = c(color_contrast_alt[2], color_palette_light(4)))
ls()
ls()
rm(list = ls())
source(
here::here(
'R',
'script_setup.R'
)
)
